---
title:"Er det høyde som bestemmer inntekt?" 
author: "Av Ann Elisabeth og Heidi Marie Rolfsnes"
output: html_document
bibliography: MasterDronningene.bib
---

------------------------------------------------------------------------

# Innledning

I denne oppgaven vil vi se nærmere på om høyde har noe å si på inntekt.
Utgangspunktet for denne oppgaven bygger på datasettet heights fra
pakken modelr. Den har vi fått utdelt. Det er hentet fra National
Longitudial study, som er gjennomført på vegne av U.S Bureau of Labor
statistics.

Vi skal bruke GitHub, RStudio, og Ggplot når vi skal gjennomføre denne
undersøkelsen. Oppgaven går ut på å lage forskjellige statistikker rundt
Heights.

# Literaturgjennomgang

Formålet med denne oppgaven er å se om det er høyden som bestemmer
hvilken inntekt vi får. Når vi skal sammenligne inntekter er det nok
ikke høyde som virker som den største påvirkningskraften. Det vi ofte
hører i media er jo at en sammenligner inntekt på kjønn, alder og
bosted. Vi kan for eksempel si at menn tjener mer enn kvinner, at eldre
tjenere mer en yngre eller at folk på Østlandet tjener mer enn folk i
Nord-Norge. Noen av disse skillene er nok ikke like store lengre. Men at
det er et skille er det ingen tvil om.

Når vi nå skal finne ut om høyde har en påvirkning på inntekt vil vi
bruke forskjellige diagram og analyser. Først vil vi gjennomføre en
deskriptiv statistikk,for å få fram litt informasjon om utvalget vårt.

Vi vil gjennomføre en boxplot som er en miks av et histogram og en
numerisk analyse.

Boxploten dreier seg om data rundt medianen og viser hvordan spredningen
er i dataen[@landerEveryone]

vi vil gjennomføre et spredningsdiagram (scatter plott), i den vil vi få
en oversikt over forhold mellom inntekt og høyde. Hvert punkt i
diagrammet representerer kominasjonen mellom høyde og inntekt pr person
som er med.

Vi kommer også til å bruke regresjonsanalyse, dette bruker vi for å
finne sammenhengen av variabler. Vi bruker da en avhengig og kan bruke
en eller flere uavhengige variabler
[@johannessenForskningsmetodeOkonomiskadministrativeFag2011]. Vår
avhengige variabel er inntekt, som uavhengig variabel bruker vi høyde
men vi kommer også til å se på de andre variablene som finnes i
datasettet.

Formålet med regresjonsanalyse er tre ting, være beskrivende,
predikasjon og årsaksforklaring. Men disse er ikke nødvendigvis
gjensidig
utelukkende[@johannessenForskningsmetodeOkonomiskadministrativeFag2011]

\#Innledende tekst til oppgave

```{r}
heights$heightInt <- cut(heights$height, breaks = 8)
kable(summary(heights[,1:4]))
```

```{r}
heights$heightInt <- cut(heights$height, breaks = 8)
kable(summary(heights[,5:9]))
```

I denne tabellen har vi laget en statistikk der vi tar for oss: Inntekt,
Høyde, Vekt, Alder, Sivil status, Kjønn, Antall år med utdanning og
Scoren de fikk på AFQT. Statistikkene vi kan se er Min og Max

som vi kan sammenligne med minste inntekt og høyest inntekt, eller minst
alder og høyest alder. Median er tallet vi finner i midten. vis vi
setter opp alle inntektene i stigende rekkefølge er det tallet som er i
midten vi kaller median
[@johannessenForskningsmetodeOkonomiskadministrativeFag2011]

Videre kan vi se på Mean. dette er på norsk gjennomsnitt. som vil si
viss vi plusser sammen alle aldrene til personene i utvalget og så deler
på antallet vil vi komme frem til gjennomsnitts alderen for utvalget
vårt.

Ut fra undersøkelsen kan vi se et utvalg på 7006 personer, der 3402 er
menn og 3604 er kvinner. aldersspennet i utvalget er fra 47 til 56 år,
der medianen alder er 51 år og gjennomsnittsalderen er 51,33 år.
Inntektene til de utvalgte går fra 0 USD til 343830 USD, her kan vi også
se at medianen er 29589,50 USD mens gjennomsnittet er på 41203,90 USD.
vis vi ser på høyden så er den laveste personen 52 inch og den høyeste
er 84 Inch.

```{r}
ggplot(heights, mapping = aes(x = height, y = income)) + geom_point()

```

Diagrammet viser høyde i forhold til inntekt. På den vertikale linjen
finner vi inntekten, og på den horisontale finner vi høyden. Her ser vi
at en liten gruppe med folk i alle høyder som har en relativt høyere
inntekt en resten, mellom denne gruppen og resten av utvalget er det et
stort gap. noe vi kan kjenne oss igjen i når vi ser på den deskriptive
statistikken.

```{r}
heightsPosInc <- subset(heights, income > 0)
ggplot(heightsPosInc, mapping = aes(x = heightInt, y = income)) + scale_y_continuous(trans = scales::log_trans()) +geom_boxplot()
```

I Boxplotet ser vi inntekt i forhold til HeightInt

```{r}
heightsPosInc <- subset(heights, income > 0)
ggplot(heightsPosInc, mapping = aes(x = height, y = income)) +scale_y_continuous(trans = scales::log_trans()) + geom_point(position = "jitter") +geom_smooth(method ='lm')
## ‘geom_smooth()‘ using formula ’y ~ x’
```

I punkt diagrammet ser vi inntekt og høyde mot hverandre, hver prikk
representerer en person i utvalget med personens høyde og inntekt.

```{r}
heightsPosInc <- subset(heights, income > 0)
ggplot(heightsPosInc, mapping = aes(x = height, y = income)) +geom_point(position = "jitter") + geom_smooth(method ='lm')

```

Hvor mye tjener vi pr ekstra inch?

```{r}
summary(lm(income ~ height, data = heights))

```

En ekstra inch (2,72cm) gir oss \$2982 ekstra i inntekt pr år.

Er det mer til historien?

# Oppgave 2 - Hoyde

```{r}
eval = FALSE
data("heights", package = "modelr")
hoyde= heights
```

1.  Beskrivende statistikk , dvs. kort beskrivelse av dataene

    I denne oversikten ser vi skilte kvinner på 49 år og 68 inch samt
    gifte menn på 52 år og 65 inch er de som tjener mest. ut i fra denne
    oversikten. ut i fra høyde ser vi at gifte kvinner på 70 inch tjener
    betydelig lavere enn skilte kvinner på 68 inch. Vi skal nå se
    nermere på statistikkene og lager et histogram.

    ```{r}
    library(ggplot2)
    data("heights")
    head(heights)
    ```

    2.  Lag et histogram av variabelen income

        I dette histogramet ser vi en oversikt over hvor mye hver person
        har i inntekt.

    ```{r}
    hist(heights$income, main = "Income Histogram", xlab = "Income")

    ```

2.1 Hva er forklaringen på utliggerne langt til høyre?

Grunnen til at det ligger en søyle helt til høyre er på grunn av at det
er en andel personer i utvalget som har en vesentlig høyere inntekt enn
det resterende utvalget. ut i fra histogrammet kan vi se at fleste
tjener under 50000.

2.2 Har vi personer uten inntekt i datasettet?

Når vi ser i histogrammet kan vi se en andel personer med 0 i inntekt.

# Regresjonsanalyse

Nå skal vi gjennomføre regresjonsanalyse. Først har vi laget en plot som
viser inntekt i forhold til høyden.

```{r}
hoyde %>% 
# plot av inntekt mot høyde
ggplot(mapping = aes(x = height, y = income)) +
geom_point() +
#geom_point(mapping = aes(colour = sex), alpha = 0.5) +
geom_smooth(method = "lm", formula = 'y ~ x', se = FALSE)
  

```

så har vi tatt bort de som har 0 i inntekt, for å teste modellens
robusthet. vi bruker filter fra funksjonen tidyverse. vi har lagt inn
skille for å se forskjell på kvinner og menn.

```{r}
# tømmer hoyde datasettet inn i en pipe
 hoyde %>% 
   filter(income > 0) %>% 
   filter(income < 340000) %>% 
   ggplot(mapping = aes(x = height, y = income, colour = sex)) +
   geom_point(mapping = aes(colour = sex), alpha = 0.5) +
   geom_smooth(method = "lm", formula = 'y ~ x', se = FALSE)

```

I dette plottet ser vi inntekt mot utdanning og kjønn. Her ser vi at
menn ligger noe høyere enn kvinner i forhold til inntekt, fordi om de
har like lang utdanning. Her ser vi at høyre siden består mest av menn.
Generelt er mennene høyere enn kvinnene i dette utvalget, men utfra
denne oversikten kan vi ikke si at høyde har en påvirkning på inntekt.

```{r}
hoyde %>% 
   filter(income > 0) %>% 
   filter(income < 340000) %>% 
   ggplot(mapping = aes(x = education, y = log(income), colour = sex)) +
   geom_point(mapping = aes(colour = sex), alpha = 0.5) +
   geom_smooth(method = "lm", formula = 'y ~ x', se = FALSE)
```

I denne boxplotten har vi delt oversikten på kjønn. et boxplott tar
utgangspunkt i median. Vi kan her se at høye menn på 80 inch har flest
treff på 50 000 dollar. mens på kvinne siden er det flest damer som er
55 inch som har 25000 doller i inntekt.

```{r}
hoyde %>% 
   filter(income > 0) %>% 
   filter(income < 340000) %>% 
   ggplot(mapping = aes(x = height, y = income)) +
   facet_wrap('~sex') +
   geom_boxplot(aes(group = cut_width(height, 5)))

```

I dette histogrammet har vi også delt inn i kjønn, som vi så i den
deskriptive statistikken så var det 3402 menn og 3604 kvinner som deltok
i utvalget. Når vi ser på denne oversikten ser vi at det er flere menn
en kvinner som har høyere inntekt.

```{r}
hoyde %>% 
   filter(income > 0) %>% 
   filter(income < 340000) %>% 
   ggplot(mapping = aes(x = log(income))) +
   facet_wrap('~sex') +
   geom_histogram()

```

I denne oversikten har vi sett på sivilstatus.

```{r}
hoyde %>% 
  mutate(
  married = factor(
    case_when(
      marital == "married" ~ TRUE,
      TRUE ~ FALSE
    )
  )
)

```

```{r}
 hoyde %>% 
   filter(income > 0) %>% 
   filter(income < 340000) %>% 
   ggplot(mapping = aes(x = marital, y = income, colour = sex)) +
   geom_point(mapping = aes(colour = sex), alpha = 0.5) +
   geom_smooth(method = "lm", formula = 'y ~ x', se = FALSE) 
```

```{r}
library(huxtable)
```

```{r}
summary(heights)
```

```{r}
huxreg(
  list("Modell 1" = lm3, "Modell 2" = lm3_red),
  error_format = "[{statistic}]",
  note = "Regresjonstabell 3: {stars}. T statistics in brackets."
  )

```

```{r}
lm1 <- lm(income ~ height, data = heights)
lm2 <- lm(income ~ height + sex + age, data = heights)
lm3 <- lm(income ~ sex + education + marital, data = heights)

```

```{r}
summary(lm2)

```

```{r}
huxreg(lm1, lm2, lm3)

```

```{r}
huxreg(lm1, lm2, lm3,
       error_format = "[{statistic}]",
       note         = "{stars}. T statistics in brackets."
       )

```

```{r}
lm1_red <- lm(income ~ height, data = heights[-c(0,5, 340000), ])
lm2_red <- lm(income ~ height + sex + age,data = heights[-c(0,5, 340000), ])
lm3_red <- lm(income ~ sex + education + marital,data = heights[-c(0,5, 340000), ])

```

```{r}
huxreg(
  lm3, lm3_red,
  error_format = "[{statistic}]",
  note         = "{stars}. T statistics in brackets."
  )

```

# Konklusjon

Det er ikke høyde som bestemmer inntekt. Forskjellene er mellom kjønn

# Referanse

```{r}
knitr::write_bib()

```

```{r}
knitr::write_bib(file = 'packages.bib')

```
