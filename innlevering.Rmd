---
title:"Er det høyde som bestemmer inntekt?" 
author: "Av Ann Elisabeth og Heidi Marie Rolfsnes"
---

------------------------------------------------------------------------

# Innledning

I denne oppgaven vil vi se nærmere på om høyde har noe å si på inntekt.
Utgangspunktet for denne oppgaven bygger på et datasett vi har fått
utdelt. Det er hentet fra National Longitudial study, som er gjennomført
på vegne av U.S Bureau of Labor statistics.

vi skal bruke GitHub, RStudio og Ggplot når vi skal gjennomføre denne
undersøkelsen.

# Teori

Formålet med denne oppgaven er å se om det er høyden som bestemmer
hvilken inntekt vi får. Når vi skal sammenligne inntekter er det nok
ikke høyde som virker som den største påvirkningskraften. Det vi ofte
hører i media er jo at en sammenligner inntekt på kjønn, alder og
bosted. Vi kan for eksempel si at menn tjener mer enn kvinner, at eldre
tjenere mer en yngre eller at folk på Østlandet tjener mer enn folk i
Nord-Norge. Noen av disse skillene er nok ikke like store lengre. Men at
det er et skille er det ingen tvil om.

Når vi nå skal finne ut om høyde har en påvirkning på inntekt vil vi
bruke forskjellige diagram og analyser. Først vil vi gjennomføre en
deskriptiv statistikk,for å få fram litt informasjon om utvalget vårt.

Vi vil gjennomføre en boxplot som er en miks av et histogram og en
numerisk analyse.

Boxploten dreier seg om data rundt medianen og viser hvordan spredningen
er i dataen.(fin kilde).

vi vil gjennomføre et spredningsdiagram (scatter plott), i den vil vi få
en oversikt over forhold mellom inntekt og høyde. Hvert punkt i
diagrammet representerer kominasjonen mellom høyde og inntekt pr person
som er med.

Vi kommer også til å bruke regresjonsanalyse, dette bruker vi for å
finne sammenhengen av variabler. Vi bruker da en avhengig og kan bruke
en eller flere uavhengige variabler (boka s.458). Vår avhengige variabel
er inntekt, som uavhengig variabel bruker vi høyde men vi kommer også
til å se på kjønn (evt fleire)

Formålet med regresjonsanalyse er tre ting, være beskrivende,
predikasjon og årsaksforklaring. Men disse er ikke nødvendigvis
gjensidig utelukkende (bok s.335)

# Statistikk

Innledende tekst til oppgave

```{r}
heights$heightInt <- cut(heights$height, breaks = 8)
kable(summary(heights[,1:4]))
```

```{r}
heights$heightInt <- cut(heights$height, breaks = 8)
kable(summary(heights[,5:9]))
```

I denne tabellen har vi laget en statistikk der vi tar for oss: Inntekt,
Høyde, Vekt, Alder, Sivil status, Kjønn, Antall år med utdanning og
Scoren de fikk på AFQT. Statistikkene vi kan se er Min og Max

som vi kan sammenligne med minste inntekt og høyest inntekt, eller minst
alder og høyest alder. Median er tallet vi finner i midten. vis vi
setter opp alle inntektene i stigende rekkefølge er det tallet som er i
midten vi kaller median (boka side 300). videre kan vi se på Mean. dette
er på norsk gjennomsnitt. som vil si viss vi plusser sammen alle aldrene
til personene i utvalget og så deler på antallet vil vi komme frem til
gjennomsnitts alderen for utvalget vårt.

Ut fra undersøkelsen kan vi se et utvalg på 7006 personer, der 3402 er
menn og 3604 er kvinner. aldersspennet i utvalget er fra 47 til 56 år,
der medianen alder er 51 år og gjennomsnittsalderen er 51,33 år.
Inntektene til de utvalgte går fra 0 USD til 343830 USD, her kan vi også
se at medianen er 29589,50 USD mens gjennomsnittet er på 41203,90 USD.
vis vi ser på høyden så er den laveste personen 52 inch og den høyeste
er 84 Inch.

```{r}
ggplot(heights, mapping = aes(x = height, y = income)) + geom_point()

```

Diagrammet viser høyde i forhold til inntekt. På den vertikale linjen
finner vi inntekten, og på den horisontale finner vi høyden. Her ser vi
at en liten gruppe med folk i alle høyder som har en relativt høyere
inntekt en resten, mellom denne gruppen og resten av utvalget er det et
stort gap. noe vi kan kjenne oss igjen i når vi ser på den deskriptive
statistikken.

```{r}
heightsPosInc <- subset(heights, income > 0)
ggplot(heightsPosInc, mapping = aes(x = heightInt, y = income)) + scale_y_continuous(trans = scales::log_trans()) +geom_boxplot()
```

I Boxplotet ser vi inntekt i forhold til HeightInt

```{r}
heightsPosInc <- subset(heights, income > 0)
ggplot(heightsPosInc, mapping = aes(x = height, y = income)) +scale_y_continuous(trans = scales::log_trans()) + geom_point(position = "jitter") +geom_smooth(method ='lm')
## ‘geom_smooth()‘ using formula ’y ~ x’
```

I punkt diagrammet ser vi inntekt og høyde mot hverandre, hver prikk
representerer en person i utvalget med personens høyde og inntekt.

```{r}
heightsPosInc <- subset(heights, income > 0)
ggplot(heightsPosInc, mapping = aes(x = height, y = income)) +geom_point(position = "jitter") + geom_smooth(method ='lm')

```

Hvor mye tjener vi pr ekstra inch?

```{r}
summary(lm(income ~ height, data = heights))

```

En ekstra inch (2,72cm) gir oss \$2982 ekstra i inntekt pr år.

Er det mer til historien?

# Oppgave 2 - Hoyde

```{r}
eval = FALSE
data("heights", package = "modelr")
hoyde= heights
```

1.  Beskrivende statistikk , dvs. kort beskrivelse av dataene

2.  Lag et histogram av variabelen income

    ```{r}
    library(ggplot2)
    data("heights")
    head(heights)
    ```

    ```{r}
    hist(heights$income, main = "Income Histogram", xlab = "Income")

    ```

2.1 Hva er forklaringen på utliggerne langt til høyre?

Grunnen til at det ligger en søyle helt til høyre er på grunn av at det
er en andel personer i utvalget som har en vesentlig høyere inntekt enn
det resterende utvalget. ut i fra histogrammet kan vi se at fleste
tjener under 50000.

2.2 Har vi personer uten inntekt i datasettet?

Når vi ser i histogrammet kan vi se en andel personer med mindre enn 0 i
inntekt.

```{r}
hoyde %>% 
# plot av inntekt mot høyde
ggplot(mapping = aes(x = height, y = income)) +
geom_point() +
#geom_point(mapping = aes(colour = sex), alpha = 0.5) +
geom_smooth(method = "lm", formula = 'y ~ x', se = FALSE)
  

```

# Regresjonsanalyse

Uten inntekt 0:

```{r}
# tømmer hoyde datasettet inn i en pipe
 hoyde %>% 
   filter(income > 0) %>% 
   filter(income < 340000) %>% 
   ggplot(mapping = aes(x = height, y = income, colour = sex)) +
   geom_point(mapping = aes(colour = sex), alpha = 0.5) +
   geom_smooth(method = "lm", formula = 'y ~ x', se = FALSE)

```

Inntekt mot høyde.

```{r}
hoyde %>% 
   filter(income > 0) %>% 
   filter(income < 340000) %>% 
   ggplot(mapping = aes(x = education, y = log(income), colour = sex)) +
   geom_point(mapping = aes(colour = sex), alpha = 0.5) +
   geom_smooth(method = "lm", formula = 'y ~ x', se = FALSE)
```

Når vi splitter på kjønn

Hvert med 5b inch bredde (høyde i intervaller

```{r}
hoyde %>% 
   filter(income > 0) %>% 
   filter(income < 340000) %>% 
   ggplot(mapping = aes(x = height, y = income)) +
   facet_wrap('~sex') +
   geom_boxplot(aes(group = cut_width(height, 5)))

```

Inntekt fordelt på kjønn

```{r}
hoyde %>% 
   filter(income > 0) %>% 
   filter(income < 340000) %>% 
   ggplot(mapping = aes(x = log(income))) +
   facet_wrap('~sex') +
   geom_histogram()

```

```{r}
hoyde %>% 
  mutate(
  married = factor(
    case_when(
      marital == "married" ~ TRUE,
      TRUE ~ FALSE
    )
  )
)

```

```{r}
huxreg(
  list("Modell 4" = lm3, "Modell 5" = lm3_nhi),
 error_format = "[{statistic}]"
 ,note = "Regresjonstabell 3: {stars}. T statistics in brackets."
 )

```

```{r}
mod1 <- "inntekt ~ hoyde_cm"
lm1 <- (mod1, data = hoyde, subset = complete.cases(hoyde))
```

```{r}
Summary(lm1)

```

# Konklusjon

Det er ikke høyde som bestemmer inntekt. Forskjellene er mellom kjønn.

# Litteraturgjennomgang

# Referanser
